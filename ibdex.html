<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flappy Bird</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&amp;display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    .game-font {
      font-family: 'Press Start 2P', cursive;
    }
    
    .bird {
      transition: transform 0.1s ease-out;
    }
    
    .pipe {
      background: linear-gradient(90deg, #73bf2e 0%, #5a9e1f 50%, #73bf2e 100%);
      border: 4px solid #2d5016;
      border-radius: 4px;
    }
    
    .pipe-cap {
      background: linear-gradient(90deg, #73bf2e 0%, #5a9e1f 50%, #73bf2e 100%);
      border: 4px solid #2d5016;
      border-radius: 4px;
    }
    
    .ground {
      background: linear-gradient(0deg, #ded895 0%, #d2c46c 100%);
      border-top: 4px solid #5a3921;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    .floating {
      animation: float 1s ease-in-out infinite;
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full overflow-hidden">
  <div id="game-container" class="relative w-full h-full overflow-hidden" style="background: linear-gradient(180deg, #4ec0ca 0%, #70c5ce 50%, #b0e0e6 100%);"><!-- Clouds -->
   <div class="absolute top-8 left-10 w-20 h-8 bg-white rounded-full opacity-80"></div>
   <div class="absolute top-6 left-16 w-12 h-6 bg-white rounded-full opacity-80"></div>
   <div class="absolute top-12 right-20 w-24 h-10 bg-white rounded-full opacity-80"></div>
   <div class="absolute top-10 right-28 w-14 h-7 bg-white rounded-full opacity-80"></div><!-- Game Canvas -->
   <div id="game-area" class="relative w-full h-full"><!-- Bird -->
    <div id="bird" class="bird absolute w-12 h-10 floating" style="left: 80px; top: 50%;">
     <svg viewbox="0 0 48 40" class="w-full h-full"><!-- Body --> <ellipse cx="24" cy="20" rx="20" ry="16" fill="#f8d347" /> <ellipse cx="24" cy="20" rx="18" ry="14" fill="#f9e076" /> <!-- Wing --> <ellipse cx="18" cy="22" rx="10" ry="8" fill="#e6a323" /> <!-- Eye white --> <circle cx="30" cy="14" r="8" fill="white" /> <!-- Eye pupil --> <circle cx="32" cy="14" r="4" fill="#333" /> <!-- Eye highlight --> <circle cx="33" cy="12" r="1.5" fill="white" /> <!-- Beak --> <polygon points="38,20 48,22 38,26" fill="#e84c3d" /> <polygon points="38,22 46,22 38,24" fill="#c0392b" />
     </svg>
    </div><!-- Pipes Container -->
    <div id="pipes-container" class="absolute inset-0 pointer-events-none"></div><!-- Ground -->
    <div id="ground" class="ground absolute bottom-0 left-0 right-0 h-24">
     <div class="absolute top-0 left-0 right-0 h-4 bg-gradient-to-b from-green-600 to-green-700"></div>
    </div><!-- Score -->
    <div id="score-display" class="absolute top-8 left-1/2 transform -translate-x-1/2 game-font text-4xl text-white drop-shadow-lg" style="text-shadow: 2px 2px 0 #333, -2px -2px 0 #333, 2px -2px 0 #333, -2px 2px 0 #333;">
     0
    </div><!-- Start Screen -->
    <div id="start-screen" class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-30">
     <h1 id="game-title" class="game-font text-3xl text-white mb-8 text-center px-4" style="text-shadow: 3px 3px 0 #333;">Flappy Bird</h1>
     <div class="bg-yellow-400 hover:bg-yellow-300 px-8 py-4 rounded-lg cursor-pointer transform hover:scale-105 transition-transform border-4 border-yellow-600 shadow-lg" onclick="startGame()"><span class="game-font text-lg text-yellow-900">TAP TO PLAY</span>
     </div>
     <p class="game-font text-xs text-white mt-6 opacity-80">Press SPACE or TAP to flap</p>
    </div><!-- Game Over Screen -->
    <div id="game-over-screen" class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-50 hidden">
     <div class="bg-orange-100 rounded-xl p-8 border-4 border-orange-400 shadow-2xl text-center">
      <h2 class="game-font text-2xl text-orange-800 mb-4">GAME OVER</h2>
      <div class="mb-4">
       <p class="game-font text-sm text-orange-700 mb-2">SCORE</p>
       <p id="final-score" class="game-font text-3xl text-orange-900">0</p>
      </div>
      <div class="mb-6">
       <p class="game-font text-sm text-orange-700 mb-2">BEST</p>
       <p id="best-score" class="game-font text-2xl text-orange-800">0</p>
      </div>
      <div class="bg-green-500 hover:bg-green-400 px-6 py-3 rounded-lg cursor-pointer transform hover:scale-105 transition-transform border-4 border-green-700" onclick="restartGame()"><span class="game-font text-sm text-white">PLAY AGAIN</span>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
    // Default configuration
    const defaultConfig = {
      game_title: 'Flappy Bird'
    };

    // Game state
    let gameRunning = false;
    let gameOver = false;
    let score = 0;
    let bestScore = 0;
    
    // Bird properties
    let birdY = 0;
    let birdVelocity = 0;
    const gravity = 0.35;
    const flapStrength = -8;
    const birdX = 80;
    
    // Pipe properties
    let pipes = [];
    const pipeWidth = 60;
    const pipeGap = 150;
    const pipeSpeed = 3;
    let pipeSpawnTimer = 0;
    const pipeSpawnInterval = 100;
    
    // Elements
    const bird = document.getElementById('bird');
    const pipesContainer = document.getElementById('pipes-container');
    const scoreDisplay = document.getElementById('score-display');
    const startScreen = document.getElementById('start-screen');
    const gameOverScreen = document.getElementById('game-over-screen');
    const finalScoreEl = document.getElementById('final-score');
    const bestScoreEl = document.getElementById('best-score');
    const gameContainer = document.getElementById('game-container');
    const gameTitle = document.getElementById('game-title');
    
    // Get game dimensions
    function getGameHeight() {
      return gameContainer.clientHeight;
    }
    
    function getGameWidth() {
      return gameContainer.clientWidth;
    }
    
    // Initialize bird position
    function initBird() {
      birdY = getGameHeight() / 2 - 20;
      birdVelocity = 0;
      updateBirdPosition();
    }
    
    // Update bird visual position
    function updateBirdPosition() {
      const rotation = Math.min(Math.max(birdVelocity * 3, -30), 90);
      bird.style.top = birdY + 'px';
      bird.style.transform = `rotate(${rotation}deg)`;
    }
    
    // Flap the bird
    function flap() {
      if (!gameRunning || gameOver) return;
      birdVelocity = flapStrength;
      bird.classList.remove('floating');
    }
    
    // Create a pipe
    function createPipe() {
      const gameHeight = getGameHeight();
      const groundHeight = 96;
      const minTop = 80;
      const maxTop = gameHeight - groundHeight - pipeGap - 80;
      const topPipeHeight = Math.random() * (maxTop - minTop) + minTop;
      
      const pipeX = getGameWidth();
      
      // Create pipe elements
      const topPipe = document.createElement('div');
      topPipe.className = 'pipe absolute';
      topPipe.style.width = pipeWidth + 'px';
      topPipe.style.height = topPipeHeight + 'px';
      topPipe.style.left = pipeX + 'px';
      topPipe.style.top = '0px';
      
      const topCap = document.createElement('div');
      topCap.className = 'pipe-cap absolute';
      topCap.style.width = (pipeWidth + 10) + 'px';
      topCap.style.height = '24px';
      topCap.style.left = (pipeX - 5) + 'px';
      topCap.style.top = (topPipeHeight - 24) + 'px';
      
      const bottomPipeTop = topPipeHeight + pipeGap;
      const bottomPipeHeight = gameHeight - groundHeight - bottomPipeTop;
      
      const bottomPipe = document.createElement('div');
      bottomPipe.className = 'pipe absolute';
      bottomPipe.style.width = pipeWidth + 'px';
      bottomPipe.style.height = bottomPipeHeight + 'px';
      bottomPipe.style.left = pipeX + 'px';
      bottomPipe.style.top = bottomPipeTop + 'px';
      
      const bottomCap = document.createElement('div');
      bottomCap.className = 'pipe-cap absolute';
      bottomCap.style.width = (pipeWidth + 10) + 'px';
      bottomCap.style.height = '24px';
      bottomCap.style.left = (pipeX - 5) + 'px';
      bottomCap.style.top = bottomPipeTop + 'px';
      
      pipesContainer.appendChild(topPipe);
      pipesContainer.appendChild(topCap);
      pipesContainer.appendChild(bottomPipe);
      pipesContainer.appendChild(bottomCap);
      
      pipes.push({
        x: pipeX,
        topHeight: topPipeHeight,
        bottomTop: bottomPipeTop,
        topPipe,
        topCap,
        bottomPipe,
        bottomCap,
        scored: false
      });
    }
    
    // Update pipes
    function updatePipes() {
      for (let i = pipes.length - 1; i >= 0; i--) {
        const pipe = pipes[i];
        pipe.x -= pipeSpeed;
        
        pipe.topPipe.style.left = pipe.x + 'px';
        pipe.topCap.style.left = (pipe.x - 5) + 'px';
        pipe.bottomPipe.style.left = pipe.x + 'px';
        pipe.bottomCap.style.left = (pipe.x - 5) + 'px';
        
        // Check for score
        if (!pipe.scored && pipe.x + pipeWidth < birdX) {
          pipe.scored = true;
          score++;
          scoreDisplay.textContent = score;
        }
        
        // Remove off-screen pipes
        if (pipe.x + pipeWidth < -10) {
          pipe.topPipe.remove();
          pipe.topCap.remove();
          pipe.bottomPipe.remove();
          pipe.bottomCap.remove();
          pipes.splice(i, 1);
        }
      }
    }
    
    // Check collision
    function checkCollision() {
      const gameHeight = getGameHeight();
      const groundHeight = 96;
      const birdTop = birdY + 6;
      const birdBottom = birdY + 26;
      const birdLeft = birdX + 4;
      const birdRight = birdX + 36;
      
      // Ground collision
      if (birdBottom >= gameHeight - groundHeight) {
        return true;
      }
      
      // Ceiling collision
      if (birdTop <= 0) {
        return true;
      }
      
      // Pipe collision
      for (const pipe of pipes) {
        const pipeLeft = pipe.x;
        const pipeRight = pipe.x + pipeWidth;
        
        if (birdRight > pipeLeft && birdLeft < pipeRight) {
          // Check top pipe
          if (birdTop < pipe.topHeight) {
            return true;
          }
          // Check bottom pipe
          if (birdBottom > pipe.bottomTop) {
            return true;
          }
        }
      }
      
      return false;
    }
    
    // Game loop
    function gameLoop() {
      if (!gameRunning || gameOver) return;
      
      // Update bird physics
      birdVelocity += gravity;
      birdY += birdVelocity;
      updateBirdPosition();
      
      // Spawn pipes
      pipeSpawnTimer++;
      if (pipeSpawnTimer >= pipeSpawnInterval) {
        createPipe();
        pipeSpawnTimer = 0;
      }
      
      // Update pipes
      updatePipes();
      
      // Check collision
      if (checkCollision()) {
        endGame();
        return;
      }
      
      requestAnimationFrame(gameLoop);
    }
    
    // Start game
    function startGame() {
      gameRunning = true;
      gameOver = false;
      score = 0;
      pipes = [];
      pipeSpawnTimer = 80;
      
      // Clear pipes
      pipesContainer.innerHTML = '';
      
      // Reset displays
      scoreDisplay.textContent = '0';
      startScreen.classList.add('hidden');
      gameOverScreen.classList.add('hidden');
      
      // Initialize bird
      initBird();
      bird.classList.remove('floating');
      
      // Start game loop
      gameLoop();
    }
    
    // End game
    function endGame() {
      gameRunning = false;
      gameOver = true;
      
      if (score > bestScore) {
        bestScore = score;
      }
      
      finalScoreEl.textContent = score;
      bestScoreEl.textContent = bestScore;
      gameOverScreen.classList.remove('hidden');
    }
    
    // Restart game
    function restartGame() {
      startGame();
    }
    
    // Input handlers
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        if (!gameRunning && !gameOver) {
          startGame();
        } else if (gameOver) {
          restartGame();
        } else {
          flap();
        }
      }
    });
    
    document.addEventListener('click', (e) => {
      if (e.target.closest('#start-screen') || e.target.closest('#game-over-screen')) return;
      if (gameRunning && !gameOver) {
        flap();
      }
    });
    
    document.addEventListener('touchstart', (e) => {
      if (e.target.closest('#start-screen') || e.target.closest('#game-over-screen')) return;
      if (gameRunning && !gameOver) {
        e.preventDefault();
        flap();
      }
    }, { passive: false });
    
    // Initialize
    initBird();
    
    // Element SDK initialization
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          const title = config.game_title || defaultConfig.game_title;
          gameTitle.textContent = title;
        },
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['game_title', config.game_title || defaultConfig.game_title]
        ])
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d4ac9dea0b4ee23',t:'MTc3MjIyNzg4MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
